{"config":{"lang":["es"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Sistema de Biblioteca Universitaria","text":"<p>\u00a1Bienvenido a la documentaci\u00f3n del Sistema de PIGBU Biblioteca Universitaria!</p>"},{"location":"#arquitectura-del-sistema","title":"Arquitectura del Sistema","text":"<pre><code>graph TB\n    Frontend[Frontend Flask] --&gt; Gateway[API Gateway]\n    Gateway --&gt; Auth[Autenticaci\u00f3n]\n    Gateway --&gt; Catalog[Cat\u00e1logo]\n    Gateway --&gt; Loans[Pr\u00e9stamos]\n    Gateway --&gt; Reservations[Reservas]\n\n    Auth --&gt; PG[(PostgreSQL)]\n    Catalog --&gt; Mongo[(MongoDB)]\n    Loans --&gt; PG\n    Reservations --&gt; Redis[(Redis)]\n</code></pre>"},{"location":"#caracteristicas","title":"Caracter\u00edsticas","text":"<ul> <li>\u2705 Autenticaci\u00f3n con JWT</li> <li>\u2705 Cat\u00e1logo de libros</li> <li>\u2705 Sistema de pr\u00e9stamos</li> <li>\u2705 Reservas con cola</li> </ul>"},{"location":"#inicio","title":"Inicio","text":"<p>Crea las imagenes de contenedores</p> <p><pre><code>docker-compose build --no-cache\n</code></pre> Levanta el servicio </p> <pre><code>docker-compose up\n</code></pre> <p>Accede a: http://localhost:5000</p>"},{"location":"architecture/overview/","title":"Visi\u00f3n General de la Arquitectura","text":""},{"location":"architecture/overview/#introduccion","title":"Introducci\u00f3n","text":"<p>El Sistema de PIGBU Biblioteca Universitaria implementa una arquitectura de microservicios que divide la aplicaci\u00f3n en servicios independientes, cada uno con una responsabilidad espec\u00edfica y bien definida.</p>"},{"location":"architecture/overview/#principios-arquitectonicos","title":"Principios Arquitect\u00f3nicos","text":""},{"location":"architecture/overview/#1-separacion-de-responsabilidades","title":"1. Separaci\u00f3n de Responsabilidades","text":"<p>Cada microservicio tiene una \u00fanica responsabilidad bien definida:</p> <ul> <li>Autenticaci\u00f3n: Gesti\u00f3n de usuarios y seguridad</li> <li>Cat\u00e1logo: Informaci\u00f3n de libros y recursos</li> <li>Pr\u00e9stamos: Transacciones de pr\u00e9stamo y devoluci\u00f3n</li> <li>Reservas: Sistema de reservas y cola de espera</li> </ul>"},{"location":"architecture/overview/#2-autonomia-de-servicios","title":"2. Autonom\u00eda de Servicios","text":"<p>Los servicios son independientes y pueden:</p> <ul> <li>Desplegarse de forma independiente</li> <li>Escalar seg\u00fan necesidad</li> <li>Usar diferentes tecnolog\u00edas</li> <li>Tener su propia base de datos</li> </ul>"},{"location":"architecture/overview/#3-comunicacion-por-api","title":"3. Comunicaci\u00f3n por API","text":"<p>La comunicaci\u00f3n entre componentes se realiza mediante:</p> <ul> <li>HTTP/REST: Para comunicaci\u00f3n s\u00edncrona</li> <li>JSON: Como formato de intercambio de datos</li> <li>JWT: Para autenticaci\u00f3n y autorizaci\u00f3n</li> </ul>"},{"location":"architecture/overview/#diagrama-de-arquitectura-completo","title":"Diagrama de Arquitectura Completo","text":"<pre><code>graph TB\n    subgraph \"Usuario Final\"\n        U[Navegador Web]\n    end\n\n    subgraph \"Frontend Layer\"\n        FE[Flask FrontendPuerto 5000]\n    end\n\n    subgraph \"API Gateway Layer\"\n        GW[API GatewayPuerto 8000]\n        MW1[Middleware: CORS]\n        MW2[Middleware: Auth]\n        MW3[Middleware: Logging]\n    end\n\n    subgraph \"Microservices Layer\"\n        AUTH[Auth ServicePuerto 8001]\n        CAT[Catalog ServicePuerto 8002]\n        LOAN[Loans ServicePuerto 8003]\n        RES[Reservations ServicePuerto 8004]\n    end\n\n    subgraph \"Data Layer\"\n        PG[(PostgreSQLPuerto 5432)]\n        MONGO[(MongoDBPuerto 27017)]\n        REDIS[(RedisPuerto 6379)]\n    end\n\n    subgraph \"Container Orchestration\"\n        DOCKER[Docker Compose]\n    end\n\n    U --&gt;|HTTPS| FE\n    FE --&gt;|REST API| GW\n    GW --&gt; MW1\n    MW1 --&gt; MW2\n    MW2 --&gt; MW3\n    MW3 --&gt; AUTH\n    MW3 --&gt; CAT\n    MW3 --&gt; LOAN\n    MW3 --&gt; RES\n\n    AUTH ---|SQL| PG\n    LOAN ---|SQL| PG\n    CAT ---|NoSQL| MONGO\n    RES ---|Cache| REDIS\n\n    DOCKER -.-&gt;|Gestiona| FE\n    DOCKER -.-&gt;|Gestiona| GW\n    DOCKER -.-&gt;|Gestiona| AUTH\n    DOCKER -.-&gt;|Gestiona| CAT\n    DOCKER -.-&gt;|Gestiona| LOAN\n    DOCKER -.-&gt;|Gestiona| RES\n    DOCKER -.-&gt;|Gestiona| PG\n    DOCKER -.-&gt;|Gestiona| MONGO\n    DOCKER -.-&gt;|Gestiona| REDIS\n\n    style U fill:#64b5f6\n    style FE fill:#81c784\n    style GW fill:#ffb74d\n    style AUTH fill:#ba68c8\n    style CAT fill:#4db6ac\n    style LOAN fill:#f06292\n    style RES fill:#fff176\n    style PG fill:#90a4ae\n    style MONGO fill:#a1887f\n    style REDIS fill:#ef5350\n</code></pre>"},{"location":"architecture/overview/#capas-del-sistema","title":"Capas del Sistema","text":""},{"location":"architecture/overview/#1-capa-de-presentacion","title":"1. Capa de Presentaci\u00f3n","text":"<p>Frontend con Flask</p> <p>Proporciona la interfaz de usuario web:</p> <pre><code>Frontend\n\u251c\u2500\u2500 Templates (HTML/Jinja2)\n\u251c\u2500\u2500 Static Assets (CSS/JS)\n\u2514\u2500\u2500 L\u00f3gica de Presentaci\u00f3n\n</code></pre> <p>Caracter\u00edsticas:</p> <ul> <li>Dise\u00f1o responsivo con CSS moderno</li> <li>JavaScript vanilla para interactividad</li> <li>Integraci\u00f3n con API Gateway</li> <li>Manejo de sesiones y tokens</li> </ul>"},{"location":"architecture/overview/#2-capa-de-gateway","title":"2. Capa de Gateway","text":"<p>API Gateway</p> <p>Punto de entrada \u00fanico para todas las peticiones:</p> <pre><code># Ejemplo de configuraci\u00f3n del Gateway\nfrom fastapi import FastAPI\nfrom fastapi.middleware.cors import CORSMiddleware\n\napp = FastAPI()\n\n# Middleware de CORS\napp.add_middleware(\n    CORSMiddleware,\n    allow_origins=[\"*\"],\n    allow_credentials=True,\n    allow_methods=[\"*\"],\n    allow_headers=[\"*\"],\n)\n</code></pre> <p>Responsabilidades:</p> <ul> <li>Enrutamiento de peticiones</li> <li>Autenticaci\u00f3n centralizada</li> <li>Rate limiting</li> <li>Logging y monitoreo</li> <li>Manejo de errores global</li> </ul>"},{"location":"architecture/overview/#3-capa-de-microservicios","title":"3. Capa de Microservicios","text":"<p>Cada microservicio implementa l\u00f3gica de negocio espec\u00edfica:</p>"},{"location":"architecture/overview/#servicio-de-autenticacion","title":"Servicio de Autenticaci\u00f3n","text":"<pre><code>sequenceDiagram\n    participant U as Usuario\n    participant GW as API Gateway\n    participant AUTH as Auth Service\n    participant DB as PostgreSQL\n\n    U-&gt;&gt;GW: POST /auth/login\n    GW-&gt;&gt;AUTH: Reenv\u00eda petici\u00f3n\n    AUTH-&gt;&gt;DB: Valida credenciales\n    DB--&gt;&gt;AUTH: Usuario encontrado\n    AUTH--&gt;&gt;AUTH: Genera JWT\n    AUTH--&gt;&gt;GW: Token JWT\n    GW--&gt;&gt;U: Token + Info Usuario\n</code></pre>"},{"location":"architecture/overview/#servicio-de-catalogo","title":"Servicio de Cat\u00e1logo","text":"<pre><code>sequenceDiagram\n    participant U as Usuario\n    participant GW as API Gateway\n    participant CAT as Catalog Service\n    participant DB as MongoDB\n\n    U-&gt;&gt;GW: GET /catalog/books?search=python\n    GW-&gt;&gt;CAT: Reenv\u00eda petici\u00f3n\n    CAT-&gt;&gt;DB: Busca libros\n    DB--&gt;&gt;CAT: Lista de libros\n    CAT--&gt;&gt;GW: JSON con resultados\n    GW--&gt;&gt;U: Respuesta formateada\n</code></pre>"},{"location":"architecture/overview/#servicio-de-prestamos","title":"Servicio de Pr\u00e9stamos","text":"<pre><code>sequenceDiagram\n    participant U as Usuario\n    participant GW as API Gateway\n    participant LOAN as Loans Service\n    participant DB as PostgreSQL\n    participant CAT as Catalog Service\n\n    U-&gt;&gt;GW: POST /loans/create\n    GW-&gt;&gt;LOAN: Reenv\u00eda petici\u00f3n\n    LOAN-&gt;&gt;CAT: Verifica disponibilidad\n    CAT--&gt;&gt;LOAN: Libro disponible\n    LOAN-&gt;&gt;DB: Crea pr\u00e9stamo\n    DB--&gt;&gt;LOAN: Pr\u00e9stamo creado\n    LOAN-&gt;&gt;CAT: Actualiza disponibilidad\n    LOAN--&gt;&gt;GW: Confirmaci\u00f3n\n    GW--&gt;&gt;U: Pr\u00e9stamo exitoso\n</code></pre>"},{"location":"architecture/overview/#servicio-de-reservas","title":"Servicio de Reservas","text":"<pre><code>sequenceDiagram\n    participant U as Usuario\n    participant GW as API Gateway\n    participant RES as Reservations Service\n    participant CACHE as Redis\n    participant CAT as Catalog Service\n\n    U-&gt;&gt;GW: POST /reservations/create\n    GW-&gt;&gt;RES: Reenv\u00eda petici\u00f3n\n    RES-&gt;&gt;CAT: Verifica disponibilidad\n    CAT--&gt;&gt;RES: No disponible\n    RES-&gt;&gt;CACHE: A\u00f1ade a cola\n    CACHE--&gt;&gt;RES: Posici\u00f3n en cola\n    RES--&gt;&gt;GW: Reserva confirmada\n    GW--&gt;&gt;U: N\u00famero en cola\n</code></pre>"},{"location":"architecture/overview/#4-capa-de-datos","title":"4. Capa de Datos","text":"<p>El sistema utiliza m\u00faltiples tecnolog\u00edas de almacenamiento:</p> PostgreSQLMongoDBRedis <p>Uso: Datos transaccionales y relacionales</p> <ul> <li>Usuarios y autenticaci\u00f3n</li> <li>Pr\u00e9stamos y devoluciones</li> <li>Historial de transacciones</li> </ul> <p>Ventajas: - Relaciones complejas - Integridad referencial</p> <p>Uso: Documentos y datos no estructurados</p> <ul> <li>Cat\u00e1logo de libros</li> <li>Metadatos bibliogr\u00e1ficos</li> <li>B\u00fasquedas flexibles</li> </ul> <p>Ventajas: - Esquema flexible - B\u00fasquedas de texto completo - Escalabilidad horizontal</p> <p>Uso: Cach\u00e9 y datos temporales</p> <ul> <li>Cola de reservas</li> <li>Sesiones activas</li> <li>Cach\u00e9 de consultas</li> </ul> <p>Ventajas: - Acceso ultra r\u00e1pido - Estructuras de datos avanzadas - Expiraci\u00f3n autom\u00e1tica</p>"},{"location":"architecture/overview/#consideraciones-de-seguridad","title":"Consideraciones de Seguridad","text":""},{"location":"architecture/overview/#autenticacion-y-autorizacion","title":"Autenticaci\u00f3n y Autorizaci\u00f3n","text":"<pre><code>graph LR\n    A[Usuario] --&gt;|Credenciales| B[Login]\n    B --&gt;|JWT| C[Token]\n    C --&gt;|Header| D[Request]\n    D --&gt;|Valida| E[Gateway]\n    E --&gt;|OK| F[Microservicio]\n    E --&gt;|Fail| G[401 Unauthorized]\n\n    style C fill:#4caf50\n    style E fill:#ff9800\n    style G fill:#f44336\n</code></pre>"},{"location":"architecture/overview/#principios-aplicados","title":"Principios Aplicados","text":"<ol> <li>Autenticaci\u00f3n en Gateway: Validaci\u00f3n centralizada de tokens</li> <li>JWT con Expiraci\u00f3n: Tokens de corta duraci\u00f3n</li> <li>HTTPS: Encriptaci\u00f3n de datos en tr\u00e1nsito</li> </ol>"},{"location":"architecture/overview/#escalabilidad","title":"Escalabilidad","text":""},{"location":"architecture/overview/#estrategias-de-escalado","title":"Estrategias de Escalado","text":"<pre><code>graph TB\n    subgraph \"Horizontal Scaling\"\n        LB[Load Balancer]\n        MS1[Microservice Instance 1]\n        MS2[Microservice Instance 2]\n        MS3[Microservice Instance 3]\n\n        LB --&gt; MS1\n        LB --&gt; MS2\n        LB --&gt; MS3\n    end\n\n    subgraph \"Database Scaling\"\n        MASTER[(Master DB)]\n        REPLICA1[(Replica 1)]\n        REPLICA2[(Replica 2)]\n\n        MASTER -.-&gt;|Replication| REPLICA1\n        MASTER -.-&gt;|Replication| REPLICA2\n    end\n\n    MS1 &amp; MS2 &amp; MS3 --&gt; MASTER\n    MS1 &amp; MS2 &amp; MS3 -.-&gt;|Read| REPLICA1 &amp; REPLICA2\n</code></pre> <p>Documentaci\u00f3n de Microservicios</p> <p>Para detalles espec\u00edficos de cada microservicio, consulta la secci\u00f3n Microservicios.</p>"},{"location":"guides/installation/","title":"Gu\u00eda de Instalaci\u00f3n","text":""},{"location":"guides/installation/#requisitos","title":"Requisitos","text":"<ul> <li>Docker 20.10+</li> <li>Docker Compose 2.0+</li> <li>Python 3.11+</li> </ul>"},{"location":"guides/installation/#instalacion-con-docker","title":"Instalaci\u00f3n con Docker","text":"<pre><code># Clonar repositorio\ngit clone https://github.com/jefersalcedo/biblioteca_universitaria\n\n# Navegar al directorio\ncd biblioteca_universitaria\n\n# Iniciar servicios\ndocker-compose build --no-cache\n\ndocker-compose up \n</code></pre>"},{"location":"guides/installation/#acceder","title":"Acceder","text":"<ul> <li>Frontend: http://localhost:5000</li> <li>API Gateway: http://localhost:8000</li> </ul>"},{"location":"microservices/authentication/","title":"Microservicio de Autenticaci\u00f3n","text":""},{"location":"microservices/authentication/#descripcion","title":"Descripci\u00f3n","text":"<p>El microservicio de autenticaci\u00f3n es responsable de gestionar todos los aspectos relacionados con usuarios, sesiones y seguridad del sistema.</p>"},{"location":"microservices/authentication/#responsabilidades","title":"Responsabilidades","text":"<pre><code>\u2705Registro de nuevos usuarios\n\u2705Autenticaci\u00f3n con credenciales\n\u2705Generaci\u00f3n y validaci\u00f3n de token JWT\n\u2705Gesti\u00f3n de roles y permisos \n\u2705 Recuperaci\u00f3n de contrase\u00f1as\n\u2705Gesti\u00f3n de sesiones\n</code></pre>"},{"location":"microservices/authentication/#arquitectura-del-servicio","title":"Arquitectura del servicio","text":"<pre><code>graph TB\n  subgraph \"API Endpoints\"\n      EP1[POST /register]\n      EP2[POST /login]\n      EP3[GET /me]\n      EP4[POST /refresh]\n  end\n\n  subgraph \"Business Logic\"\n      BL[Auth Service]\n      JWT[JWT Manager]\n      HASH[Password Hasher]\n  end\n\n  subgraph \"Data Access\"\n      MODELS[SQLAlchemy Models]\n      DB[(PostgreSQL)]\n  end\n\n  EP1 &amp; EP2 &amp; EP3 &amp; EP4 --&gt; BL\n  BL --&gt; JWT\n  BL --&gt; HASH\n  BL --&gt; MODELS\n  MODELS --&gt; DB\n\n  style EP1 fill:#e3f2fd\n  style EP2 fill:#e3f2fd\n  style EP3 fill:#e3f2fd\n  style EP4 fill:#e3f2fd\n  style BL fill:#f3e5f5\n  style DB fill:#c8e6c9\n</code></pre>"},{"location":"microservices/authentication/#endpoints","title":"Endpoints","text":""},{"location":"microservices/authentication/#post-authlogin","title":"POST /auth/login","text":"<p>Autentica un usuario y retorna un token JWT.</p> <p>Request: <pre><code>{\n  \"email\": \"usuario@ejemplo.com\",\n  \"password\": \"contrase\u00f1a_segura\"\n}\n</code></pre></p> <p>Response: <pre><code>{\n  \"access_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\n  \"token_type\": \"bearer\",\n  \"user\": {\n    \"id\": 1,\n    \"email\": \"usuario@ejemplo.com\",\n    \"username\": \"usuario123\",\n    \"role\": \"user\"\n  }\n}\n</code></pre></p>"},{"location":"microservices/authentication/#flujo-del-login","title":"Flujo del Login","text":"<pre><code>sequenceDiagram\n    participant C as Cliente\n    participant API as Auth API\n    participant DB as PostgreSQL\n\n    C-&gt;&gt;API: POST /login\n    API-&gt;&gt;DB: SELECT user by email\n    DB--&gt;&gt;API: Usuario encontrado\n    API-&gt;&gt;API: Verifica password\n    API-&gt;&gt;API: Genera JWT\n    API-&gt;&gt;DB: Registra sesi\u00f3n\n    API--&gt;&gt;C: 200 + Token\n</code></pre>"},{"location":"microservices/catalog/","title":"Microservicio de Cat\u00e1logo","text":""},{"location":"microservices/catalog/#descripcion-general","title":"Descripci\u00f3n General","text":"<p>El microservicio de cat\u00e1logo es responsable de gestionar toda la informaci\u00f3n bibliogr\u00e1fica del sistema, incluyendo libros, autores, categor\u00edas y disponibilidad.</p>"},{"location":"microservices/catalog/#responsabilidades","title":"Responsabilidades","text":"<pre><code>\u2705Gesti\u00f3n de libros \n\u2705B\u00fasqueda y filtrado avanzado\n\u2705Gesti\u00f3n de categor\u00edas\n\u2705Control de disponibilidad\n\u2705Informaci\u00f3n bibliogr\u00e1fica completa\n\u2705Estad\u00edsticas del cat\u00e1logo\n</code></pre>"},{"location":"microservices/catalog/#arquitectura-del-servicio","title":"Arquitectura del Servicio","text":"<pre><code>graph TB\n    subgraph \"API Endpoints\"\n        EP1[GET /books]\n        EP2[GET /books/:id]\n        EP3[POST /books]\n        EP4[PUT /books/:id]\n        EP5[DELETE /books/:id]\n        EP6[GET /books/search]\n    end\n\n    subgraph \"Business Logic\"\n        BL[Catalog Service]\n        SEARCH[Search Engine]\n        VALID[Validator]\n    end\n\n    subgraph \"Data Layer\"\n        MODELS[Mongoose Models]\n        DB[(MongoDB)]\n    end\n\n    EP1 &amp; EP2 &amp; EP3 &amp; EP4 &amp; EP5 &amp; EP6 --&gt; BL\n    BL --&gt; SEARCH\n    BL --&gt; VALID\n    BL --&gt; MODELS\n    MODELS --&gt; DB\n\n    style EP1 fill:#e3f2fd\n    style EP2 fill:#e3f2fd\n    style EP3 fill:#e3f2fd\n    style BL fill:#f3e5f5\n    style DB fill:#c8e6c9\n</code></pre>"},{"location":"microservices/catalog/#endpoints","title":"Endpoints","text":""},{"location":"microservices/catalog/#listar-todos-los-libros","title":"Listar Todos los Libros","text":"<p>Endpoint: <code>GET /catalog/books</code></p> <p>Lista todos los libros con paginaci\u00f3n.</p> <p>Query Parameters: <pre><code>page: int = 1          # N\u00famero de p\u00e1gina\nlimit: int = 10        # Libros por p\u00e1gina\ncategory: str = None   # Filtrar por categor\u00eda\n</code></pre></p> <p>Response <pre><code>{\n  \"total\": 150,\n  \"page\": 1,\n  \"limit\": 10,\n  \"books\": [\n    {\n      \"_id\": \"507f1f77bcf86cd799439011\",\n      \"isbn\": \"978-3-16-148410-0\",\n      \"title\": \"Clean Code\",\n      \"author\": \"Robert C. Martin\",\n      \"publisher\": \"Prentice Hall\",\n      \"year\": 2008,\n      \"category\": \"Programaci\u00f3n\",\n      \"description\": \"Gu\u00eda de buenas pr\u00e1cticas\",\n      \"total_copies\": 5,\n      \"available_copies\": 3,\n      \"is_available\": true,\n      \"created_at\": \"2024-01-15T10:30:00Z\"\n    }\n  ]\n}\n</code></pre></p>"},{"location":"microservices/catalog/#flujo-de-listado","title":"Flujo de Listado:","text":"<pre><code>sequenceDiagram\n    participant C as Cliente\n    participant API as Catalog API\n    participant DB as MongoDB\n\n    C-&gt;&gt;API: GET /books?page=1&amp;limit=10\n    API-&gt;&gt;DB: find().skip(0).limit(10)\n    DB--&gt;&gt;API: Lista de libros\n    API-&gt;&gt;API: Calcular total de p\u00e1ginas\n    API--&gt;&gt;C: 200 + Libros + Metadata\n</code></pre>"},{"location":"microservices/loans/","title":"Microservicio de Pr\u00e9stamos","text":""},{"location":"microservices/loans/#descripcion-general","title":"Descripci\u00f3n General","text":"<p>El microservicio de pr\u00e9stamos gestiona todo el ciclo de vida de los pr\u00e9stamos de libros, desde la solicitud hasta la devoluci\u00f3n, incluyendo el c\u00e1lculo de multas por retraso.</p>"},{"location":"microservices/loans/#responsabilidades","title":"Responsabilidades","text":"<pre><code>\u2705 Crear pr\u00e9stamos de libros\n\u2705 Devolver libros\n\u2705 Renovar pr\u00e9stamos\n\u2705 Calcular multas por retraso\n\u2705 Historial de pr\u00e9stamos\n\u2705 Reportes de pr\u00e9stamos activos\n</code></pre>"},{"location":"microservices/loans/#arquitectura-del-servicio","title":"Arquitectura del Servicio","text":"<pre><code>graph TB\n    subgraph \"API Endpoints\"\n        EP1[POST /loans]\n        EP2[GET /loans/:id]\n        EP3[POST /loans/:id/return]\n        EP4[POST /loans/:id/renew]\n        EP5[GET /loans/user/:user_id]\n    end\n\n    subgraph \"Business Logic\"\n        BL[Loans Service]\n        CALC[Fine Calculator]\n        VALID[Validator]\n    end\n\n    subgraph \"External Services\"\n        AUTH[Auth Service]\n        CAT[Catalog Service]\n    end\n\n    subgraph \"Data Layer\"\n        MODELS[SQLAlchemy Models]\n        DB[(PostgreSQL)]\n    end\n\n    EP1 &amp; EP2 &amp; EP3 &amp; EP4 &amp; EP5 --&gt; BL\n    BL --&gt; CALC\n    BL --&gt; VALID\n    BL --&gt; AUTH\n    BL --&gt; CAT\n    BL --&gt; MODELS\n    MODELS --&gt; DB\n\n    style EP1 fill:#e3f2fd\n    style BL fill:#f3e5f5\n    style DB fill:#c8e6c9\n</code></pre>"},{"location":"microservices/loans/#endpoints","title":"Endpoints","text":""},{"location":"microservices/loans/#crear-prestamo","title":"Crear Pr\u00e9stamo","text":"<p>Endpoint: <code>POST /loans</code></p> <p>Crea un nuevo pr\u00e9stamo de libro.</p> <p>Request <pre><code>{\n  \"user_id\": 123,\n  \"book_id\": \"507f1f77bcf86cd799439011\"\n}\n</code></pre></p> <p>Response <pre><code>{\n  \"id\": 1,\n  \"user_id\": 123,\n  \"book_id\": \"507f1f77bcf86cd799439011\",\n  \"loan_date\": \"2024-01-15\",\n  \"due_date\": \"2024-01-30\",\n  \"status\": \"active\",\n  \"fine_amount\": 0.00,\n  \"is_returned\": false,\n  \"message\": \"Pr\u00e9stamo creado exitosamente\"\n}\n</code></pre></p>"},{"location":"microservices/loans/#flujo-de-creacion","title":"Flujo de Creaci\u00f3n","text":"<pre><code>sequenceDiagram\n    participant U as Usuario\n    participant API as Loans API\n    participant AUTH as Auth Service\n    participant CAT as Catalog Service\n    participant DB as PostgreSQL\n\n    U-&gt;&gt;API: POST /loans\n    API-&gt;&gt;AUTH: Verificar usuario\n    AUTH--&gt;&gt;API: Usuario v\u00e1lido\n    API-&gt;&gt;CAT: GET /books/:id\n    CAT--&gt;&gt;API: Libro disponible\n    API-&gt;&gt;DB: INSERT pr\u00e9stamo\n    DB--&gt;&gt;API: Pr\u00e9stamo creado\n    API-&gt;&gt;CAT: PATCH /books/:id/availability\n    CAT--&gt;&gt;API: Disponibilidad actualizada\n    API--&gt;&gt;U: 201 + Info pr\u00e9stamo\n</code></pre>"},{"location":"microservices/reservations/","title":"Microservicio de Reservas","text":""},{"location":"microservices/reservations/#descripcion-general","title":"Descripci\u00f3n General","text":"<p>El microservicio de reservas gestiona la cola de espera para libros que no est\u00e1n disponibles, notificando a los usuarios cuando el libro que reservaron est\u00e1 disponible nuevamente.</p>"},{"location":"microservices/reservations/#responsabilidades","title":"Responsabilidades","text":"<pre><code>\u2705Crear reservas para libros no disponibles\n\u2705Notificar cuando libro est\u00e9 disponible\n\u2705Cancelar reservas\n\u2705Expiraci\u00f3n autom\u00e1tica de reservas\n\u2705Estad\u00edsticas de reservas\n</code></pre>"},{"location":"microservices/reservations/#arquitectura-del-servicio","title":"Arquitectura del Servicio","text":"<pre><code>graph TB\n    subgraph \"API Endpoints\"\n        EP1[POST /reservations]\n        EP2[GET /reservations/:id]\n        EP3[DELETE /reservations/:id]\n        EP4[GET /reservations/user/:user_id]\n        EP5[POST /reservations/:id/notify]\n    end\n\n    subgraph \"Business Logic\"\n        BL[Reservations Service]\n        QUEUE[Queue Manager]\n        NOTIF[Notification Service]\n    end\n\n    subgraph \"External Services\"\n        AUTH[Auth Service]\n        CAT[Catalog Service]\n    end\n\n    subgraph \"Data Layer\"\n        CACHE[(Redis)]\n    end\n\n    EP1 &amp; EP2 &amp; EP3 &amp; EP4 &amp; EP5 --&gt; BL\n    BL --&gt; QUEUE\n    BL --&gt; NOTIF\n    BL --&gt; AUTH\n    BL --&gt; CAT\n    BL --&gt; CACHE\n\n    style EP1 fill:#e3f2fd\n    style BL fill:#f3e5f5\n    style CACHE fill:#ffecb3\n</code></pre>"},{"location":"microservices/reservations/#endpoints","title":"Endpoints","text":""},{"location":"microservices/reservations/#crear-reserva","title":"Crear Reserva","text":"<p>Endpoint: <code>POST /reservations</code></p> <p>Crea una nueva reserva para un libro no disponible.</p> <p>Request <pre><code>{\n  \"user_id\": 123,\n  \"book_id\": \"507f1f77bcf86cd799439011\"\n}\n</code></pre></p> <p>Response <pre><code>{\n  \"reservation_id\": \"res_1705329600_123\",\n  \"user_id\": 123,\n  \"book_id\": \"507f1f77bcf86cd799439011\",\n  \"book_title\": \"Clean Code\",\n  \"reservation_date\": \"2024-01-15T10:30:00Z\",\n  \"status\": \"pending\",\n  \"position_in_queue\": 3,\n  \"estimated_wait_days\": 45,\n  \"message\": \"Reserva creada exitosamente. Eres el n\u00famero 3 en la cola.\"\n}\n</code></pre></p>"},{"location":"microservices/reservations/#flujo-de-creacion","title":"Flujo de Creaci\u00f3n","text":"<pre><code>sequenceDiagram\n    participant U as Usuario\n    participant API as Reservations API\n    participant CAT as Catalog Service\n    participant REDIS as Redis\n\n    U-&gt;&gt;API: POST /reservations\n    API-&gt;&gt;CAT: GET /books/:id\n    CAT--&gt;&gt;API: Libro NO disponible\n    API-&gt;&gt;REDIS: LLEN book:queue:{book_id}\n    REDIS--&gt;&gt;API: 2 en cola\n    API-&gt;&gt;REDIS: RPUSH book:queue:{book_id}\n    API-&gt;&gt;REDIS: SET reservation:{id}\n    REDIS--&gt;&gt;API: Guardado\n    API--&gt;&gt;U: 201 + Posici\u00f3n: 3\n</code></pre>"}]}